@page "/Memory"
@inject NavigationManager NavManager
@inject IDialogService DialogService
@using Fluid.Client.Pages.Dialogs
@using Fluid.Shared.Enums.Technical;
<MudTable Dense Elevation=0 Outlined Hover T="MemoryModel" Items="Memories" Filter="new Func<MemoryModel,bool>(FilterFunc)">
    <ToolBarContent>
        <MudButton Color=Color.Success OnClick="OpenDialog" Variant=Variant.Filled DisableElevation StartIcon="@Icons.Material.Filled.Add">
            Create
        </MudButton>
        <MudButton Color=Color.Tertiary Class="ma-2" Variant=Variant.Filled DisableElevation StartIcon="@Icons.Material.Filled.Refresh">
            Reload
        </MudButton>
        <MudButton Color=Color.Info Class="ma-2" Variant=Variant.Filled DisableElevation StartIcon="@Icons.Custom.FileFormats.FileExcel">
            Export
        </MudButton>
        <MudSpacer />
        <MudTextField @bind-Value="searchString" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Serial Number</MudTh>
        <MudTh>Manufacturer</MudTh>
        <MudTh>Capacity in GB</MudTh>
        <MudTh>Memory Type</MudTh>
        <MudTh>Speed</MudTh>
        <MudTh>Form Factor</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd>@context.SerialNumber</MudTd>
        <MudTd>@context.Manufacturer</MudTd>
        <MudTd>@context.CapacityInGB</MudTd>
        <MudTd>@context.MemoryType</MudTd>
        <MudTd>@context.Speed</MudTd>
        <MudTd>@context.FormFactor</MudTd>
    </RowTemplate>
    <NoRecordsContent>
        <MudText>No matching records found</MudText>
    </NoRecordsContent>
    <LoadingContent>
        <MudText>Loading...</MudText>
    </LoadingContent>
    <PagerContent>
        <MudTablePager HideRowsPerPage/>
    </PagerContent>
</MudTable>
@code{
    private List<MemoryModel> Memories = new List<MemoryModel>()
    {
        new MemoryModel()
        {
            SerialNumber="1234",
            Manufacturer="Zebronic",
            CapacityInGB=8,
            MemoryType=MemoryType.DRAM,
            Speed=1335,
            FormFactor=MemoryFormFactor.SRIMM
        }
        ,
        new MemoryModel()
        {
            SerialNumber="2813",
            Manufacturer="Sapphire",
            CapacityInGB=7,
            MemoryType=MemoryType.DDR5,
            Speed=1181,
            FormFactor=MemoryFormFactor.Other
        }
        ,
        new MemoryModel()
        {
            SerialNumber="2932",
            Manufacturer="Asus",
            CapacityInGB=6,
            MemoryType=MemoryType.DDR2_FB_DIMM,
            Speed=1321,
            FormFactor=MemoryFormFactor.SRIMM
        }
        ,
        new MemoryModel()
        {
            SerialNumber="3891",
            Manufacturer="Intel",
            CapacityInGB=8,
            MemoryType=MemoryType.FLASH,
            Speed=1331,
            FormFactor=MemoryFormFactor.Other
        }
    };
    private string searchString = null;
    private bool FilterFunc(MemoryModel memory)
    {
        if (string.IsNullOrWhiteSpace(searchString))
            return true;
        if (memory.SerialNumber.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (memory.Manufacturer.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (memory.CapacityInGB.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (memory.MemoryType.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (memory.Speed.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (memory.FormFactor.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if ($"{memory.SerialNumber} {memory.Manufacturer} {memory.CapacityInGB} {memory.MemoryType} {memory.Speed} {memory.FormFactor}".Contains(searchString))
            return true;
        return false;
    }
    private void OpenDialog()
    {
		var options = new DialogOptions { CloseOnEscapeKey = true };
        DialogService.Show<MemoryDialog>("", options);
    }
}